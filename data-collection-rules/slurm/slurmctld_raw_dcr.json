{
  "type": "Microsoft.Insights/dataCollectionRules",
  "name": "slurmctld_raw_dcr",
  "description": "DCR for ingesting slurmctld.log from Slurm controller",
  "location": "{location-name}",
  "kind": "Linux",
  "properties": {
    "dataFlows": [
      {
        "streams": ["Custom-Text-slurmctld_raw_CL"],
        "destinations": ["{workspace-name}"],
        "outputStream": "Custom-slurmctld_raw_CL",
        "transformKql": "source"
      }
    ],
    "dataSources": {
      "logFiles": [
        {
          "filePatterns": ["/var/log/slurmctld/slurmctld.log"],
          "format": "text",
          "name": "Custom-Text-slurmctld_raw_CL",
          "streams": ["Custom-Text-slurmctld_raw_CL"]
        }
      ]
    },
    "streamDeclarations": {
      "Custom-Text-slurmctld_raw_CL": {
        "columns": [
          {
            "name": "TimeGenerated",
            "type": "datetime"
          },
          {
            "name": "RawData",
            "type": "string"
          },
          {
            "name": "Computer",
            "type": "string"
          },
          {
            "name": "FilePath",
            "type": "string"
          }
        ]
      }
    },
    "destinations": {
      "logAnalytics": [
        {
          "name": "{workspace-name}",
          "workspaceResourceId": "/subscriptions/{subscription-id}/resourceGroups/{resource-group}/providers/Microsoft.OperationalInsights/workspaces/{workspace-name}"
        }
      ]
    }
  }
}
